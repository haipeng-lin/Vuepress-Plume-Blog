---
title: 日志管理
createTime: 2025/01/15 23:10:20
permalink: /project/MiniDB/fcnnttao/
---
## 1.设计思路

​		DM 层对底层数据进行操作时，都会==将一条日志记录到磁盘上==。在数据库崩溃后，再次启动时，系统可以根据这些日志内容恢复数据文件，从而确保数据的完整性

## 2.日志格式

```
[XChecksum][log1][log2][BadTail]
```

> - `XChecksum`：四字节的整数，是对后续所有日志计算的校验和
> - `Log1 ~ LogN`：常规的日志数据
> - `BadTail`：数据库崩溃时尚未写完的日志数据（可能不存在）

每条日志结构：

```
[Size][Checksum][Data]
```

## 3.日志文件的校验和



## 4.日志文件的创建与初始化



## 5.MiniDB恢复策略详解