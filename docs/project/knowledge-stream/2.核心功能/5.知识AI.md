---
title: çŸ¥è¯†AI
createTime: 2025/07/02 16:12:52
permalink: /project/knowledge-stream/fne3lams/
---

## 1.å‰è¨€

&emsp;&emsp; åŸºäºç­–ç•¥æ¨¡å¼å°è£…å¤š LLM æ¨¡å‹ï¼ˆè®¯é£æ˜Ÿç«ã€é€šä¹‰åƒé—®ã€æ™ºè°±ï¼‰ï¼Œç»“åˆå¤§æ¨¡å‹çš„ Stream API ä¸ SSE å®ç°å›ç­”é€æ­¥è¾“å‡º

## 2.ç­–ç•¥æ¨¡å¼

### 2.1 ä»‹ç»

å®šä¹‰ï¼šç­–ç•¥æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶æ ¹æ®ä¸åŒçš„ç­–ç•¥é€‰æ‹©ä¸åŒçš„ç®—æ³•æˆ–è€…è¡Œä¸º

ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹ï¼š

- å°†ç®—æ³•çš„å®šä¹‰å’Œä½¿ç”¨åˆ†ç¦»ï¼Œ**ç¬¦åˆå¼€é—­åŸåˆ™**ï¼Œæ–¹ä¾¿æ‰©å±•æ·»åŠ æ–°çš„ç®—æ³•ï¼Œåªéœ€è¦å¢åŠ æ–°çš„å…·ä½“ç­–ç•¥ç±»ï¼Œä¸éœ€è¦ä¿®æ”¹ç­–ç•¥ä¸Šä¸‹æ–‡
- ä»£æ›¿åŸæ¥å¤§é‡çš„æ¡ä»¶åˆ¤æ–­è¯­å¥ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§

ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹ï¼š

- å®¢æˆ·ç«¯éœ€è¦äº†è§£ä¸åŒçš„ç­–ç•¥ç±»ï¼Œ**æ¥é€‰æ‹©åˆé€‚çš„ç­–ç•¥å¯¹è±¡**ï¼Œå¢åŠ äº†å®¢æˆ·ç«¯çš„å¤æ‚æ€§
- ç­–ç•¥æ¨¡å¼å¢åŠ äº†å¯¹è±¡çš„æ•°é‡ï¼Œæ¯ä¸ªå…·ä½“ç­–ç•¥ç±»éƒ½éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ï¼Œå¯¼è‡´ç³»ç»Ÿä¸­å¯¹è±¡æ•°é‡å¢åŠ 

> è§£å†³ç¬¬ä¸€ä¸ªç¼ºç‚¹çš„æ–¹æ³•ï¼š**å¤–è§‚æ¨¡å¼**
>
> å¤–è§‚æ¨¡å¼æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œ èƒ½ä¸ºç¨‹åºåº“ã€ æ¡†æ¶æˆ–å…¶ä»–å¤æ‚ç±»**æä¾›ä¸€ä¸ªç®€å•çš„æ¥å£**
>
> ChatFacade å¤–è§‚æ¨¡å¼æ¥è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå°†å…·ä½“çš„ AI é€‰æ‹©é€»è¾‘ç»™å±è”½äº†ï¼Œå¯¹äºè°ƒç”¨è€…è€Œè¨€ï¼Œç›´æ¥è°ƒç”¨ **chatService.autoChat**ï¼ˆaisourceï¼Œquestionï¼Œcallbackï¼‰

### 2.2 ä½¿ç”¨å§¿åŠ¿

- å®šä¹‰æŠ½è±¡ç­–ç•¥æ¥å£ï¼šè®¾è®¡ä¸€ä¸ªé€šç”¨çš„ ChatService æ¥å£ï¼Œå®šä¹‰èŠå¤©ç›¸å…³çš„æ–¹æ³•

  ```java
  public interface ChatService {
  
      /**
       * å…·ä½“AIé€‰æ‹©
       */
      AISourceEnum source();
  
      /**
       * æ˜¯å¦æ—¶å¼‚æ­¥ä¼˜å…ˆ
       */
      default boolean asyncFirst() {
          return true;
      }
  
      /**
       * å¼€å§‹è¿›å…¥èŠå¤©
       */
      ChatRecordsVo chat(Long user, String question);
  
      /**
       * å¼€å§‹è¿›å…¥èŠå¤©
       */
      ChatRecordsVo chat(Long user, String question, Consumer<ChatRecordsVo> consumer);
  
      /**
       * å¼‚æ­¥èŠå¤©
       */
      ChatRecordsVo asyncChat(Long user, String question, Consumer<ChatRecordsVo> consumer);
  
  
      /**
       * æŸ¥è¯¢èŠå¤©å†å²
       */
      ChatRecordsVo getChatHistory(Long user, AISourceEnum aiSource);
  
  }
  ```

- å…·ä½“çš„ç­–ç•¥å®ç°ï¼Œå®ç° ChatService æ¥å£å’Œæ–¹æ³•

  - XunFeiAiServicelmplï¼š è®¯é£æ˜Ÿç«å¤§æ¨¡å‹çš„èŠå¤©å®ç°
  - ZhipuAiServiceImplï¼šæ™ºè°± AI
  - AliAiServiceImplï¼šé€šä¹‰åƒé—® AI

- é€‰æ‹©ç­–ç•¥çš„ä¸Šä¸‹æ–‡ï¼šChatServiceFactory

  è¿™é‡Œä¸»è¦å€ŸåŠ©äº†Springçš„bean Listæ³¨å…¥æ–¹å¼ï¼Œä¸€æ¬¡æ‹¿åˆ°ä¸Šé¢çš„è¿™äº›ç­–ç•¥å®ç°ï¼Œç„¶åä¿å­˜åˆ°ä¸€ä¸ªMapä¸­ï¼Œç„¶åæšä¸¾ AiSourceEnum æ¥è¿›è¡Œé€‰æ‹©å…·ä½“çš„ç­–ç•¥

  ```java
  @Component
  public class ChatServiceFactory {
      private final Map<AISourceEnum, ChatService> chatServiceMap;
  
  
      public ChatServiceFactory(List<ChatService> chatServiceList) {
          chatServiceMap = Maps.newHashMapWithExpectedSize(chatServiceList.size());
          for (ChatService chatService : chatServiceList) {
              chatServiceMap.put(chatService.source(), chatService);
          }
      }
  
      public ChatService getChatService(AISourceEnum aiSource) {
          return chatServiceMap.get(aiSource);
      }
  }
  ```

- å¤–è§‚æ¨¡å¼

  ```java
  public ChatRecordsVo autoChat(AISourceEnum source, String question, Consumer<ChatRecordsVo> callback) {
        if (source.asyncSupport() && chatServiceFactory.getChatService(source).asyncFirst()) {
            // æ”¯æŒå¼‚æ­¥ä¸”å¼‚æ­¥ä¼˜å…ˆçš„åœºæ™¯ä¸‹ï¼Œè‡ªåŠ¨é€‰æ‹©å¼‚æ­¥æ–¹å¼è¿›è¡ŒèŠå¤©
            return asyncChat(source, question, callback);
        }
        return chat(source, question, callback);
    }
  ```

## 3.åˆ‡æ¢è¯­è¨€å¤§æ¨¡å‹

### 3.1 å®¢æˆ·ç«¯

&emsp;&emsp;æ¯å½“æˆ‘ä»¬åœ¨é¡µé¢ä¸Šåˆ‡æ¢å¤§æ¨¡å‹æ—¶ï¼Œéƒ½ä¼šå»ºç«‹ä¸€ä¸ª websocket è¿æ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ŒåŒ…å«äº† ws://åœ°å€/gpt/ id / å¤§æ¨¡å‹ç±»å‹	

![image-20250703181455323](https://gcore.jsdelivr.net/gh/haipeng-lin/blog-img/20250703181455.png)

é¡µé¢æºç å¦‚ä¸‹ï¼šæ¯æ¬¡åˆ‡æ¢å¤§æ¨¡å‹ï¼Œéƒ½ä¼šæ‰§è¡Œ initWs æ–¹æ³•

```html
function initWs() {
      let protocol = window.location.protocol.replace("http", "ws");
      let host = window.location.host;
      let aiType = $('#chat-type').val();
      console.log("AITYPE = ", aiType);

      let socket = new WebSocket(`${protocol}//${host}/gpt/${session}/${aiType}`);
      stompClient = Stomp.over(socket);
      stompClient.connect({}, function (frame) {
          console.log('wsè¿æ¥æˆåŠŸ: ' + frame);
          wsConnected = true;
          inputField.removeAttr("disabled");
          // æ”¹å˜ inputField çš„ placeholder
          inputField.val("");
          inputField.attr("placeholder", "å¯æŒ‰å›è½¦å‘é€");
          sendBtnText.text("å‘é€");
          sendBtn.removeAttr("disabled");
          // æ”¹å˜ chatTitle çš„å†…å®¹
          chatTitle.text(user.userName);
```

### 3.2 æœåŠ¡ç«¯é…ç½®æ¶ˆæ¯ä»£ç†

- stompåè®®çš„websocketå®ç°çš„chatgptèŠå¤©æ–¹å¼

```java
@Slf4j
@Configuration
@EnableWebSocketMessageBroker // å¼€å¯websocketä»£ç†
public class WsChatConfig implements WebSocketMessageBrokerConfigurer {
}
```

WsChatConfig ç±»æ·»åŠ ä¸€ä¸ªæœåŠ¡ç«¯ç‚¹ï¼Œæ¥æ¥æ”¶å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå³å®¢æˆ·ç«¯åˆ›å»ºwsæ—¶ï¼ŒæŒ‡å®šçš„åœ°å€, chat/index.html: let socket = new WebSocket(`${protocol}//${host}/gpt/${session}/${aiType}`);

```java
@Override
public void registerStompEndpoints(StompEndpointRegistry registry) {
    // æ³¨å†Œä¸€ä¸ª /gpt/{id} çš„ WebSocket endPoint; å…¶ä¸­ {id} ç”¨äºè®©ç”¨æˆ·è¿æ¥ç»ˆç«¯æ—¶éƒ½å¯ä»¥æœ‰è‡ªå·±çš„è·¯å¾„
    // ä½œä¸º Principal çš„æ ‡è¯†ï¼Œä»¥ä¾¿å®ç°å‘æŒ‡å®šç”¨æˆ·å‘é€ä¿¡æ¯
    // sockjs å¯ä»¥è§£å†³æµè§ˆå™¨å¯¹ WebSocket çš„å…¼å®¹æ€§é—®é¢˜ï¼Œ
    registry.addEndpoint("/gpt/{id}/{aiType}", "/notify")
            .setHandshakeHandler(new AuthHandshakeHandler())
            .addInterceptors(new AuthHandshakeInterceptor())
            // æ³¨æ„ä¸‹é¢è¿™ä¸ªï¼Œä¸è¦ä½¿ç”¨ setAllowedOrigins("*")ï¼Œä½¿ç”¨ä¹‹åæœ‰å•¥é—®é¢˜å¯ä»¥å®æ“éªŒè¯ä¸€ä¸‹ğŸ•
            // setAllowedOriginsæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œæ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ªå…è®¸è®¿é—®çš„å®¢æˆ·ç«¯åœ°å€ï¼Œå†…éƒ¨çš„å€¼ä¸ºå…·ä½“çš„ "http://localhost:8080"
            // setAllowedOriginPatternsæ¥å—ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œæ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ªå…è®¸è®¿é—®çš„å®¢æˆ·ç«¯åœ°å€çš„æ¨¡å¼, å†…éƒ¨å€¼å¯ä»¥ä¸ºæ­£åˆ™ï¼Œå¦‚ "*", "http://*:8080"
            .setAllowedOriginPatterns("*")
    ;
}
```

### 3.3 æœåŠ¡ç«¯é…ç½®æ¡æ‰‹æ‹¦æˆªå™¨

æ¡æ‰‹æ‹¦æˆªå™¨ï¼Œç”¨äºç”¨æˆ·èº«ä»½æ ¡éªŒå’Œè®¾ç½®è¯­è¨€å¤§æ¨¡å‹ç±»å‹

```java
@Slf4j
public class AuthHandshakeInterceptor extends HttpSessionHandshakeInterceptor {

    /**
     * æ¡æ‰‹å‰ï¼Œè¿›è¡Œç”¨æˆ·èº«ä»½æ ¡éªŒè¯†åˆ«
     *
     * @param request
     * @param response
     * @param wsHandler
     * @param attributes: å³å¯¹åº”çš„æ˜¯Messageä¸­çš„ simpSessionAttributes è¯·æ±‚å¤´
     * @return
     * @throws Exception
     */
    @Override
    public boolean beforeHandshake(ServerHttpRequest request, ServerHttpResponse response, WebSocketHandler wsHandler, Map<String, Object> attributes) throws Exception {
        log.info("å‡†å¤‡å¼€å§‹æ¡æ‰‹äº†!");
        String session = SessionUtil.findCookieByName(request, LoginService.SESSION_KEY);
        ReqInfoContext.ReqInfo reqInfo = new ReqInfoContext.ReqInfo();
        SpringUtil.getBean(GlobalInitService.class).initLoginUser(session, reqInfo);

        if (reqInfo.getUser() == null) {
            log.info("websocket æ¡æ‰‹å¤±è´¥ï¼Œè¯·ç™»å½•ä¹‹åå†è¯•");
            return false;
        }

        // å°†ç”¨æˆ·ä¿¡æ¯å†™å…¥åˆ°å±æ€§ä¸­
        attributes.put(MdcUtil.TRACE_ID_KEY, SelfTraceIdGenerator.generate());
        attributes.put(LoginService.SESSION_KEY, reqInfo);
        attributes.put(WsAnswerHelper.AI_SOURCE_PARAM, initAiSource(request.getURI().getPath()));
        return true;
    }

    private String initAiSource(String path) {
        int index = path.lastIndexOf("/");
        return path.substring(index + 1);
    }

    @Override
    public void afterHandshake(ServerHttpRequest request, ServerHttpResponse response, WebSocketHandler wsHandler, Exception ex) {
        log.info("æ¡æ‰‹æˆåŠŸäº†!!!");
        super.afterHandshake(request, response, wsHandler, ex);
    }
}
```

### 3.3 å®¢æˆ·ç«¯å‘é€èŠå¤©æ¶ˆæ¯

```java
@MessageMapping("/chat/{session}")
public void chat(String msg,
                 @DestinationVariable("session") String session,
                 @Header("simpSessionAttributes") Map<String, Object> attrs,
                 SimpMessageHeaderAccessor accessor) {
    String aiType = (String) attrs.get(WsAnswerHelper.AI_SOURCE_PARAM);
    WebSocketResponseUtil.execute(accessor, () -> {
        log.info("{} ç”¨æˆ·å¼€å§‹äº†å¯¹è¯: {} - {}", ReqInfoContext.getReqInfo().getUser(), aiType, msg);
        AISourceEnum source = aiType == null ? null : AISourceEnum.valueOf(aiType);
        answerHelper.sendMsgToUser(source, session, msg);
    });
}
```

### 3.4 å°ç»“

1. ç”¨æˆ·æ¯æ¬¡åˆ‡æ¢å¤§æ¨¡å‹ï¼Œå®¢æˆ·ç«¯ä¼šé‡æ–°å»ºç«‹ä¸€ä¸ª websocket è¿æ¥
2. æœåŠ¡ç«¯é€šè¿‡å®ç° WebSocketMessageBrokerConfigurer æ¥å£æ¥**é…ç½® WebSocket æ¶ˆæ¯ä»£ç†**ï¼Œå¹¶é…ç½®æœåŠ¡ç«¯ç‚¹å’Œè®¾ç½®å¯¹åº”çš„æ¡æ‰‹æ‹¦æˆªå™¨
3. åœ¨æ¡æ‰‹æ‹¦æˆªå™¨ä¸­ï¼Œåœ¨æ¡æ‰‹å‰è¿›è¡Œèº«ä»½éªŒè¯æ— è¯¯åï¼Œä¿å­˜ç”¨æˆ·ä¿¡æ¯å’Œé€‰æ‹©çš„è¯­è¨€å¤§æ¨¡å‹ç±»å‹åˆ° SimpMessageHeaderAccessor çš„é”®å€¼å¯¹ä¸­
4. ç”¨æˆ·æ¯æ¬¡å‘é€è¯·æ±‚åˆ°åç«¯ä¸­ï¼Œä» SimpMessageHeaderAccessor è¯»å–åˆ°å¤§è¯­è¨€æ¨¡å‹ç±»å‹

## 4.æ¥æ”¶ç”¨æˆ·å‘é€çš„æ¶ˆæ¯

```

```



## 5.å¤„ç†å¤§æ¨¡å‹å“åº”æ¶ˆæ¯

### 5.1 DeepSeek

1. åˆå§‹åŒ–ä¸€ä¸ªåŸºäº OkHttpâ€”SSE çš„äº¤äº’å¯¹è±¡ OkHttpClient å¯¹è±¡

```java
@Slf4j
@Component
public class DeepSeekIntegration {
  @Autowired
  private DeepSeekConf deepSeekConf;

  private OkHttpClient okHttpClient;

  @PostConstruct
  public void init() {
      this.okHttpClient = new OkHttpClient.Builder()
              .connectTimeout(deepSeekConf.getTimeout(), TimeUnit.SECONDS)   // å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´
              .readTimeout(deepSeekConf.getTimeout(), TimeUnit.SECONDS)  // å»ºç«‹è¿æ¥åè¯»å–æ•°æ®çš„è¶…æ—¶æ—¶é—´
              .writeTimeout(deepSeekConf.getTimeout(), TimeUnit.SECONDS)
              .build();
  }
}
```

2. å°è£…ä¸ DeekSeek å¼€æ”¾å¹³å°çš„è¯·æ±‚äº¤äº’

```java
/**
 * ä½¿ç”¨æµå¼èŠå¤©æ¥å£å‘é€èŠå¤©è¯·æ±‚
 * è¯¥æ–¹æ³•å°†èŠå¤©è¯·æ±‚è½¬æ¢ä¸ºæµå¼è¯·æ±‚ï¼Œå¹¶ä½¿ç”¨EventSourceç›‘å¬å™¨å¤„ç†å“åº”
 *
 * @param req      èŠå¤©è¯·æ±‚å¯¹è±¡ï¼ŒåŒ…å«èŠå¤©æ‰€éœ€çš„å‚æ•°
 * @param listener EventSourceç›‘å¬å™¨ï¼Œç”¨äºå¤„ç†æœåŠ¡å™¨å‘é€çš„äº‹ä»¶
 */
private void executeStreamChat(ChatReq req, EventSourceListener listener) {
    // è®¾ç½®è¯·æ±‚ä¸ºæµå¼è¯·æ±‚
    req.setStream(true);

    try {
        // åˆ›å»ºEventSourceå·¥å‚ï¼Œç”¨äºç”ŸæˆEventSourceå¯¹è±¡
        EventSource.Factory factory = EventSources.createFactory(okHttpClient);

        // å°†èŠå¤©è¯·æ±‚å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²
        String body = JsonUtil.toStr(req);
        // æ„å»ºè¯·æ±‚å¯¹è±¡ï¼ŒæŒ‡å®šURLã€è®¤è¯å¤´ã€å†…å®¹ç±»å‹å¤´ä»¥åŠè¯·æ±‚ä½“
        Request request = new Request.Builder()
                .url(deepSeekConf.getApiHost() + "/chat/completions")
                .addHeader("Authorization", "Bearer " + deepSeekConf.getApiKey())
                .addHeader("Content-Type", "application/json")
                .post(RequestBody.create(MediaType.parse(ContentType.JSON.getValue()), body))
                .build();
        // ä½¿ç”¨å·¥å‚åˆ›å»ºæ–°çš„EventSourceï¼Œå¹¶ä¼ å…¥è¯·æ±‚å’Œç›‘å¬å™¨
        factory.newEventSource(request, listener);
    } catch (Exception e) {
        // è®°å½•è¯·æ±‚å¤±è´¥çš„æ—¥å¿—
        log.error("deepseekè”è°ƒè¯·æ±‚å¤±è´¥: {}", req, e);
    }
}
```

3. æä¾›å¯¹å¤–äº¤äº’çš„ä¸šåŠ¡æ–¹æ³•

```java
public void streamReturn(List<ChatItemVo> list, EventSourceListener listener) {
    // æ„å»ºå¤šè½®èŠå¤©çš„ä¼šè¯ä¸Šä¸‹æ–‡
    List<ChatMsg> msgList = ChatConstants.toMsgList(list, this::toMsg);
    // æ‰§è¡Œæµå¼èŠå¤©ï¼Œå°†æ„å»ºå¥½çš„å¯¹è¯ä¸Šä¸‹æ–‡ä¼ é€’ç»™èŠå¤©æœºå™¨äººï¼Œå¹¶ç›‘å¬å“åº”äº‹ä»¶
    this.executeStreamChat(msgList, listener);
}
```

4. ä½¿ç”¨

```java
@Override
public AiChatStatEnum doAsyncAnswer(Long user, ChatRecordsVo response, BiConsumer<AiChatStatEnum, ChatRecordsVo> consumer) {
    // è·å–é—®ç­”ä¸­çš„æœ€æ–°çš„è®°å½•ï¼Œç”¨äºé—®ç­”
    ChatItemVo item = response.getRecords().get(0);
    // åˆ›å»ºä¸€ä¸ªæŠ½è±¡æµç›‘å¬å™¨æ¥å¤„ç†æµå¼è¿”å›çš„ç»“æœ
    AbstractStreamListener listener = new AbstractStreamListener() {

        // å½“æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶çš„å¤„ç†
        @Override
        public void onMsg(String message) {
            // æˆåŠŸè¿”å›ç»“æœçš„åœºæ™¯, è¿‡æ»¤æ‰å¼€å¤´çš„ç©ºè¡Œ
            if (StringUtils.isNotBlank(lastMessage)) {
                item.appendAnswer(message);
                consumer.accept(AiChatStatEnum.MID, response);
                if (log.isDebugEnabled()) {
                    log.debug("DeepSeekè¿”å›å†…å®¹: {}", lastMessage);
                }
            }
        }

        // å½“é‡åˆ°é”™è¯¯æ—¶çš„å¤„ç†
        @Override
        public void onError(Throwable throwable, String res) {
            // è¿”å›å¼‚å¸¸çš„åœºæ™¯
            item.appendAnswer("Error:" + (StringUtils.isBlank(res) ? throwable.getMessage() : res))
                    .setAnswerType(ChatAnswerTypeEnum.STREAM_END);
            consumer.accept(AiChatStatEnum.ERROR, response);
            if (log.isDebugEnabled()) {
                log.debug("DeepSeekè¿”å›å¼‚å¸¸: {}", lastMessage);
            }
        }
    };

    // æ³¨å†Œå›ç­”ç»“æŸçš„å›è°ƒé’©å­
    listener.setOnComplate((s) -> {
        if (log.isDebugEnabled()) {
            log.debug("è¿™ä¸€è½®å¯¹è¯èŠå¤©å·²ç»“æŸï¼Œå®Œæ•´çš„è¿”å›ç»“æœæ˜¯ï¼š{}", s);
        }
        item.appendAnswer("\n")
                .setAnswerType(ChatAnswerTypeEnum.STREAM_END);
        consumer.accept(AiChatStatEnum.END, response);
    });
    // è°ƒç”¨æ·±åº¦å¯»æ±‚æµå¼è¿”å›çš„æ–¹æ³•
    deepSeekIntegration.streamReturn(response.getRecords(), listener);
    return AiChatStatEnum.IGNORE;
}
}
```

